<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="kde4-pre-install-config">
  <?dbhtml filename="pre-install-config.html"?>

  <sect1info>
    <othername>$LastChangedBy$</othername>
    <date>$Date$</date>
  </sect1info>

  <title>KDE4 Pre-installation Configuration</title>

  <sect2><title>Installing in /usr</title>
    
    <para>One option is to put <application>KDE4</application> into the
    <filename class='directory'>/usr</filename> hierarchy.  This creates a
    simpler setup but makes it more difficult to try multiple versions of
    <application>KDE</application>.</para>

<screen><userinput>export &kde4-dir-var;=/usr</userinput></screen>
  </sect2>
  
  <sect2><title>Installing in /opt</title>
    
    <para>A method of building multiple versions installs
    <application>KDE4</application> in the <filename
    class='directory'>/opt</filename> hierarchy:</para>

<screen><userinput>export &kde4-dir-var;=/opt/kde4</userinput></screen>

    <para>If you are not installing <application>KDE4</application> in
    <filename class="directory">/usr</filename>, you will need to make some
    additional configuration changes. Best practice is to add those to your
    system or personal profile:</para>

<screen><userinput>cat &gt; /etc/profile.d/kde4.sh &lt;&lt; "EOF"
# Begin /etc/profile.d/kde4.sh

&kde4-dir-var;=/opt/kde4
KDE4DIR=&kde4-dir;
KDEDIR=&kde4-dir;

pathappend &kde4-dir;/bin             PATH
pathappend &kde4-dir;/lib/pkgconfig   PKG_CONFIG_PATH
pathappend &kde4-dir;/share/pkgconfig PKG_CONFIG_PATH
pathappend &kde4-dir;/share           XDG_DATA_DIRS
pathappend /etc/kde4/xdg                XDG_CONFIG_DIRS

export KDE4_PREFIX KDE4DIR KDEDIR

# End /etc/profile.d/kde4.sh
EOF
</userinput></screen>

    <para>Add to your <filename>/etc/ld.so.conf</filename>:</para>

<screen role="root"><userinput>cat &gt;&gt; /etc/ld.so.conf &lt;&lt; "EOF"
<literal># Begin kde4 addition

/opt/kde4/lib

# End kde4 addition</literal>
EOF</userinput></screen>

    <indexterm zone="kde4-pre-install-config">
      <primary sortas="e-etc-ld.so.conf">/etc/ld.so.conf</primary>
    </indexterm>

    <para>Add to your <filename>/etc/man_db.conf</filename>:</para>

<screen role="root"><userinput>cat &gt;&gt; /etc/man_db.conf &lt;&lt; "EOF"
<literal># Begin kde4 addition

MANDATORY_MANPATH /opt/kde4/man

# End kde4 addition</literal>
EOF</userinput></screen>

    <indexterm zone="kde4-pre-install-config">
      <primary sortas="e-etc-man_db.conf">/etc/man_db.conf</primary>
    </indexterm>

    <para>Several KDE4 packages install files into D-BUS and polkit directories. 
    When installing KDE4 in a location other than <filename class="directory">/usr</filename>, 
    D-BUS and polkit need to find these files. The easiest way to achieve this is to create 
    the following symlinks (as the <systemitem class="username">root</systemitem> user):</para>

<screen role="root"><userinput>install -d /opt/kde4/share &amp;&amp;
ln -svf /usr/share/dbus-1 /opt/kde4/share &amp;&amp;
ln -svf /usr/share/polkit-1 /opt/kde4/share</userinput></screen>
    
    <tip>
      <para>Sometimes, the installation paths are coded into installed files.
      This is the reason why <filename class="directory">/opt/kde4</filename>
      is used as installation prefix instead of <filename
      class="directory">/opt/kde-&kde4-version;</filename>.  After installing
      <application>KDE4</application>, you may rename the directory and create
      a symlink:</para>

<screen role="root"><userinput>mv /opt/kde{4,-&kde4-version;} &amp;&amp;
ln -vsf kde-&kde4-version; /opt/kde4</userinput></screen>

      <para>Later on, you may want to install other versions of
      <application>KDE4</application>.  To do that, just remove the symlink and
      use <filename class="directory">/opt/kde4</filename> as ithe prefix again
      (<application>KDE4</application> must not be started). Which version of
      <application>KDE4</application> you use depends only on where the symlink
      points to. No other reconfiguration will be needed.</para>

    </tip>

  <!-- Moved to QT4
  <sect2><title>The QT4DIR variable</title>
  
  <para>Some additional packages which are based on
  <application>Qt4</application> will be installed. One of them is
  <application>Phonon</application>, a direct replacement of the implementation
  which comes with <application>Qt4</application>.  It's recommended placing
  such libraries in the same hierarchy where <application>Qt4</application>
  itself resides. Later on, it is refered to as <envar>QT4DIR</envar>. If you have
  placed <application>Qt4</application> in <filename
  class='directory'>/usr</filename>, set <envar>QT4DIR</envar>:</para>
  
<screen><userinput>export QT4DIR=/usr</userinput></screen>

  <para>Alternativly, <application>Qt4</application> is often placed in the
  <filename class='directory'>/opt</filename> hierarchy:</para>
  
<screen><userinput>export QT4DIR=/opt/qt-&qt4-version;
export PATH=$QT4DIR/bin:$PATH</userinput></screen>
-->
  </sect2>
</sect1>
