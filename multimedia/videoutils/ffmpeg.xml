<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
   "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY ffmpeg-download-http "http://prdownloads.sourceforge.net/ffmpeg/ffmpeg-&ffmpeg-version;.tar.gz">
  <!ENTITY ffmpeg-download-ftp  " ">
  <!ENTITY ffmpeg-md5sum        "ea5587e3c66d50b1503b82ac4179c303">
  <!ENTITY ffmpeg-size          "1.6 MB">
  <!ENTITY ffmpeg-buildsize     "62.9 MB (built with all dependencies)">
  <!ENTITY ffmpeg-time          "1.0 SBU">
]>

<sect1 id="ffmpeg" xreflabel="FFmpeg-&ffmpeg-version;">
  <?dbhtml filename="ffmpeg.html"?>

  <sect1info>
    <othername>$LastChangedBy$</othername>
    <date>$Date$</date>
    <keywordset>
      <keyword role="package">ffmpeg-&ffmpeg-version;.tar</keyword>
      <keyword role="ftpdir">ffmpeg</keyword>
    </keywordset>
  </sect1info>

  <title>FFmpeg-&ffmpeg-version;</title>

  <indexterm zone="ffmpeg">
    <primary sortas="a-FFmpeg">FFmpeg</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction to FFmpeg</title>

    <para><application>FFmpeg</application> is a solution to record, convert and
    stream audio and video. It is a very fast video and audio converter and it can
    also acquire from a live audio/video source. Designed to be intuitive, the
    command-line interface (<command>ffmpeg</command>) tries to figure out all the
    parameters, when possible. <application>FFmpeg</application> can also convert
    from any sample rate to any other, and resize video on the fly with a high
    quality polyphase filter. <application>FFmpeg</application> can use a
    video4linux compatible video source and any Open Sound System audio
    source.</para>

    <bridgehead renderas="sect3">Package Information</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Download (HTTP): <ulink url="&ffmpeg-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Download (FTP): <ulink url="&ffmpeg-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Download MD5 sum: &ffmpeg-md5sum;</para>
      </listitem>
      <listitem>
        <para>Download size: &ffmpeg-size;</para>
      </listitem>
      <listitem>
        <para>Estimated disk space required: &ffmpeg-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimated build time: &ffmpeg-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Required patch: <ulink
        url="&patch-root;/ffmpeg-&ffmpeg-version;-gcc4-1.patch"/></para>
      </listitem>
      <listitem>
        <para>Required patch: <ulink
        url="&patch-root;/ffmpeg-&ffmpeg-version;-amr_fixes-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">FFmpeg Dependencies</bridgehead>

    <bridgehead renderas="sect4">Optional</bridgehead>
    <para role="optional"><xref linkend="libvorbis"/>,
    <xref linkend="lame"/>,
    <xref linkend="imlib2"/>,
    <xref linkend="x-window-system"/>,
    <xref linkend="sdl"/>,
    <xref linkend="freetype2"/>,
    <xref linkend="mplayer"/> (for the shared post-processing library),
    <ulink url="http://sourceforge.net/projects/faac">FAAC</ulink>,
    <ulink url="http://sourceforge.net/projects/faac">FAAD2</ulink>,
    <ulink url="http://www.3gpp.org/ftp/Specs/latest/Rel-5/26_series/26104-540.zip">
    AMR narrowband (floating point)</ulink> or
    <ulink url="http://www.3gpp.org/ftp/Specs/latest/Rel-5/26_series/26073-530.zip">
    AMR naarrowband (fixed point)</ulink>,
    <ulink url="http://www.3gpp.org/ftp/Specs/latest/Rel-5/26_series/26204-530.zip">
    AMR wideband</ulink>, and
    <xref linkend="tex"/> (to build HTML documentation)</para>

    <para condition="html" role="usernotes">User Notes:
    <ulink url="&blfs-wiki;/ffmpeg"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation of FFmpeg</title>

    <para>Install <application>FFmpeg</application> by running the following
    commands:</para>

    <note>
      <para>Review the <filename>doc/optimization.txt</filename> file in the
      source tree for information about optimizing the build.</para>
    </note>

<screen><userinput>patch -Np1 -i ../ffmpeg-&ffmpeg-version;-gcc4-1.patch &amp;&amp;
patch -Np1 -i ../ffmpeg-&ffmpeg-version;-amr_fixes-1.patch &amp;&amp;
sed -i "s/static uint64/const uint64/" \
    libavcodec/liba52/resample_mmx.c &amp;&amp;
./configure --prefix=/usr --enable-shared \
    --enable-pthreads --disable-ffplay &amp;&amp;
make</userinput></screen>

    <para>If you have <application>TeX</application> installed, the man pages
    and HTML documentation were built during the <command>make</command>
    process. Skip to the <systemitem class="username">root</systemitem> user
    installation steps if you don't need other formats of the documentation, or
    issue any or all of the following commands to create the additional
    formats.</para>

<screen><userinput>for DOCFILE in faq ffmpeg-doc ffplay-doc ffserver-doc hooks
do
    texi2pdf -b $DOCFILE.texi
    texi2dvi -b $DOCFILE.texi
    dvips -o $DOCFILE.ps $DOCFILE.dvi
    makeinfo --plaintext --force -o $DOCFILE.txt $DOCFILE.texi
done</userinput></screen>

    <para>If you do not have <application>TeX</application> installed, use the
    following command to build the man pages:</para>

<screen><userinput>make -C doc ff{mpeg,play,server}.1</userinput></screen>

    <para>Now, as the <systemitem class="username">root</systemitem> user:</para>

<screen role="root"><userinput>make install</userinput></screen>

    <para>If you have <application>TeX</application> installed on your system,
    install the documentation by issuing the following commands as the
    <systemitem class="username">root</systemitem> user (modify the command
    appropriately to reflect the documentation formats you've created):</para>

<screen role="root"><userinput>install -v -m755 -d /usr/share/doc/ffmpeg-&ffmpeg-version; &amp;&amp;
install -v -m644 doc/*.{html,dvi,pdf,ps,txt}
    /usr/share/doc/ffmpeg-&ffmpeg-version;</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Command Explanations</title>

    <para><command>sed -i -e "s/static uint64/const uint64/"
    libavcodec/liba52/resample_mmx.c</command>: This command fixes an issue
    on machines with MMX capability and use <application>GCC</application> >=
    3.4.x to compile in A52 support using the <option>--enable-a52</option>
    parameter passed to the <command>configure</command> script.</para>

    <para><parameter>--enable-shared</parameter>: This switch is needed to
    build the <filename class="libraryfile">libavcodec</filename> and
    <filename class="libraryfile">libavformat</filename> shared
    libraries.</para>

    <para><parameter>--enable-pthreads</parameter>: This switch enables the
    build to link against the Posix threads library.</para>

    <para><parameter>--disable-ffplay</parameter>: Only installs the server part.
    <command>ffplay</command> requires <application>X</application> for
    building. Remove this option if <application>X</application> is
    installed.</para>

    <para><option>--enable-<replaceable>&lt;codec&gt;</replaceable></option>: Review
    the available options and codecs using the
    <command>./configure --help</command> command. Also review the information
    at the end of the configure script (<command>cat</command> the file or view
    it using a text editor) for information about building support for the AMR
    codecs.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuring FFmpeg</title>

    <sect3 id="ffmpeg-config">
      <title>Config Files</title>

      <para><filename>/etc/ffserver.conf</filename> and
      <filename>~/.ffmpeg/ffserver-config</filename></para>

      <indexterm zone="ffmpeg ffmpeg-config">
        <primary sortas="e-AA.ffmpeg-ffserver-config">~/.ffmpeg/ffserver-config</primary>
      </indexterm>

      <indexterm zone="ffmpeg ffmpeg-config">
        <primary sortas="e-etc-ffserver.conf">/etc/ffserver.conf</primary>
      </indexterm>

      <para>You'll find a sample ffserver configuration file at
      <ulink url="http://ffmpeg.sourceforge.net/sample.html"/> (also
      <filename>doc/ffserver.conf</filename> in the source tree).</para>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Installed Programs</segtitle>
      <segtitle>Installed Libraries</segtitle>
      <segtitle>Installed Directories</segtitle>

      <seglistitem>
        <seg>ffmpeg, ffserver, and optionally, ffplay</seg>
        <seg>libavcodec.so, libavformat.so, and video hook modules</seg>
        <seg>/usr/include/ffmpeg, /usr/lib/vhook, and
        /usr/share/doc/ffmpeg-&ffmpeg-version;</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Short Descriptions</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="ffmpeg-prog">
        <term><command>ffmpeg</command></term>
        <listitem>
          <para>is a command-line tool to convert video files, network streams
          and input from a TV card to several video formats.</para>
          <indexterm zone="ffmpeg ffmpeg-prog">
            <primary sortas="b-ffmpeg">ffmpeg</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ffplay">
        <term><command>ffplay</command></term>
        <listitem>
          <para>is a very simple and portable media player using the
          <filename>ffmpeg</filename> libraries and the SDL library.</para>
          <indexterm zone="ffmpeg ffplay">
            <primary sortas="b-ffplay">ffplay</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ffserver">
        <term><command>ffserver</command></term>
        <listitem>
          <para>is a streaming server for everything that <command>ffmpeg</command>
          could use as input (files, streams, TV card input, webcam, etc.).</para>
          <indexterm zone="ffmpeg ffserver">
            <primary sortas="b-ffserver">ffserver</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libavcodec">
        <term><filename class='libraryfile'>libavcodec.so</filename></term>
        <listitem>
          <para>is a library containing the <application>FFmpeg</application>
          codecs (both encoding and decoding).</para>
          <indexterm zone="ffmpeg libavcodec">
            <primary sortas="c-libavcodec">libavcodec.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libavformat">
        <term><filename class='libraryfile'>libavformat.so</filename></term>
        <listitem>
          <para>is a library containing the file formats handling (mux and demux code
          for several formats) used by <command>ffplay</command> as well as
          allowing the generation of  audio or video streams.</para>
          <indexterm zone="ffmpeg libavformat">
            <primary sortas="c-libavformat">libavformat.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
